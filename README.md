# Домашнее задание №1

## Что было сделано

1. Построен дашборд с помощью ydata-profiling для анализа данных.
2. Выполнены следующие предобработки данных:
   - Приведение строк в столбцах к единой размерности.
   - Замена пропусков на медианные значения.
   - Удаление дубликатов с обновлением индекса.
   - Приведение колонок mileage и max_power к типу float, а engine и seats — к типу int.
   - Удаление столбца torque.
3. Построены визуализации:
   - Графики попарного распределения числовых признаков.
   - Тепловая карта коэффициентов корреляции Пирсона для числовых признаков.
     - Выявлено, что engine и year наименее скоррелированы.
     - Обнаружена сильная положительная корреляция между:
       - max_power и selling_price.
       - max_power и engine.
       - engine и seats.
   - График распределения целевой переменной selling_price.
4. Обучение моделей:
   - Классическая линейная регрессия с дефолтными параметрами.
   - Стандартизированная линейная регрессия с использованием StandardScaler.
   - Применение регуляризации Лассо:
     - Весовые коэффициенты не занулились, вероятно, из-за маленьких значений коэффициентов в GridSearchCV.
   - Подбор оптимальных параметров для ElasticNet-регрессии (обучено 250 моделей).
   - Обучение модели Ridge с добавлением категориальных признаков, закодированных с помощью one-hot кодировки, и подбором параметров через GridSearchCV.

## Результаты

1. Лучшее качество моделей:
   - Модель Ridge с параметром alpha = 100 и использованием категориальных признаков.
   - Метрики:
     - $R^2 = 0.62$
     - MSE (Mean Squared Error)

2. Дополнительно разработана метрика, вычисляющая долю прогнозов, отличающихся от реальных цен на авто не более чем на 10%:
   - Лучшая модель: Ridge.
   - Значение метрики: 0.254.

3. Создан сервис на FastAPI, который:
   - Принимает файл или JSON от пользователя.
   - Предсказывает цену автомобиля (ниже представлены картинки работы сервиса).
   
Ввод json
![1 картинка](https://github.com/TaniaZharova2205/DZ1/blob/main/assets/images/1.png)

Вывод цены
![2 картинка](https://github.com/TaniaZharova2205/DZ1/blob/main/assets/images/2.png)

Загрузка файла
![3 картинка](https://github.com/TaniaZharova2205/DZ1/blob/main/assets/images/3.png)

Вывод сервиса: файл, который можно скачать
![4 картинка](https://github.com/TaniaZharova2205/DZ1/blob/main/assets/images/4.png)

Файл, с добавлением предсказания цены автомобиля 
![5 картинка](https://github.com/TaniaZharova2205/DZ1/blob/main/assets/images/5.png)

## Что дало наибольший буст в качестве

- Добавление категориальных признаков в модель и их кодирование с помощью one-hot.
- Использование Ridge-регрессии с оптимальным подбором гиперпараметра alpha через GridSearchCV.

## Что сделать не вышло и почему

- Применение регуляризации Лассо:
  - Весовые коэффициенты не занулились, что может быть связано с выбором слишком малых значений коэффициентов в GridSearchCV.

---

Этот отчёт отражает основные шаги и выводы в процессе работы над задачей анализа данных и построения моделей предсказания цены автомобилей.
